<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DemandSpot</title>
  <link rel="stylesheet" href="/style.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
    }
  
    header {
      background-color: #333;
      color: white;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }
  
    nav ul {
      list-style: none;
      display: flex;
      gap: 1rem;
      padding: 0;
      margin: 0;
      flex-wrap: wrap;
    }
  
    nav ul li a {
      color: white;
      text-decoration: none;
    }
  
    main {
      padding: 2rem;
    }
  
    section {
      margin-bottom: 3rem;
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      transition: opacity 0.4s ease, transform 0.4s ease;
    }
  
    section[style*="display: none"] {
      opacity: 0;
      transform: translateY(20px);
      height: 0;
      overflow: hidden;
      padding: 0 1.5rem;
    }
  
    form input, form button {
      padding: 0.7rem;
      margin: 0.6rem 0;
      width: 100%;
      max-width: 400px;
      display: block;
      font-size: 1rem;
    }
  
    form button {
      background-color: #28a745;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 4px;
    }
  
    #ideasContainer {
      margin-top: 1rem;
    }
  
    .idea-card {
      background: #e7f3e7;
      padding: 1rem;
      border-radius: 6px;
      margin-bottom: 1rem;
    }
    .like-btn {
    background: #ffffff;
    border: 1px solid #ccc;
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    cursor: pointer;
    margin-top: 0.5rem;
    font-size: 1rem;
    transition: background-color 0.3s;
  }

  .like-btn:hover {
    background-color: #d4edda;
  }
  
    @media (max-width: 600px) {
      header, nav ul {
        flex-direction: column;
        align-items: flex-start;
      }
  
      nav ul {
        gap: 0.5rem;
        margin-top: 0.5rem;
      }
  
      h1 {
        font-size: 1.5rem;
      }
  
      form input, form button {
        max-width: 100%;
        font-size: 1rem;
      }
  
      main {
        padding: 1rem;
      }
    }
    .like-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
  </style>
  
</head>
<body>
  <header>
    <h1>DemandSpot</h1>
    <nav>
      <ul>
        <li><a href="#starter">For Starters</a></li>
        <li><a href="#contributor">For Contributors</a></li>
      </ul>
    </nav>
  </header>
  
  <main>
    <section style="text-align: center; margin-bottom: 3rem;">
      <img src="https://images.unsplash.com/photo-1556761175-4b46a572b786" alt="Entrepreneurship" style="max-width: 100%; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1);" />
      <h2 style="margin-top: 1rem;">Discover Business Ideas That Fit Your Budget</h2>
      <p>Based on local demand, powered by real people.</p>
    </section>
  
    <section id="starter" style="display: none;">
      <h2><img src="https://cdn-icons-png.flaticon.com/512/1909/1909670.png" width="24" style="vertical-align:middle;"> Find Business Ideas in Your Budget</h2>
      <form id="starterForm">
        <label for="budget">Enter your budget ($ or ‚Çπ):</label>
        <input type="number" id="budget" name="budget" required />
        <button type="submit">Get Ideas</button>
      </form>
      <div id="ideasContainer"></div>
    </section>
  
    <section id="contributor" style="display: none;">
      <h2><img src="https://cdn-icons-png.flaticon.com/512/2583/2583243.png" width="24" style="vertical-align:middle;"> Contribute a Business Idea</h2>
      <form id="contributorForm">
        <input type="text" name="location" placeholder="Your Area/Location" required />
        <input type="text" name="idea" placeholder="Business Idea" required />
        <input type="number" name="min_budget" placeholder="Minimum Budget" required />
        <input type="number" name="max_budget" placeholder="Maximum Budget" required />
        <button type="submit">Submit Idea</button>
      </form>
      <p id="contribMessage"></p>
    </section>
  </main>
  <script>
    // Smooth transition toggle logic
    function showSection(id) {
      const starter = document.getElementById('starter');
      const contributor = document.getElementById('contributor');
  
      starter.style.display = 'none';
      contributor.style.display = 'none';
  
      setTimeout(() => {
        document.getElementById(id).style.display = 'block';
      }, 100); // Delay to allow animation
    }
  
    document.querySelector('a[href="#starter"]').addEventListener('click', function(e) {
      e.preventDefault();
      showSection('starter');
    });
  
    document.querySelector('a[href="#contributor"]').addEventListener('click', function(e) {
      e.preventDefault();
      showSection('contributor');
    });
  
    window.onload = () => showSection('starter'); // default view
  
    // Starter form functionality
    document.getElementById('starterForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const budget = document.getElementById('budget').value;
  
      const res = await fetch('/api/ideas?budget=' + budget);
      const ideas = await res.json();
  
      const container = document.getElementById('ideasContainer');
      container.innerHTML = '';
      if (ideas.length === 0) {
        container.innerHTML = '<p>No ideas found for this budget range.</p>';
      } else {
        ideas.forEach(idea => {
          const div = document.createElement('div');
          div.className = 'idea-card';
          div.textContent = idea.idea + ' (in ' + idea.location + ')';
          container.appendChild(div);
        });
      }
    });
  
    // Contributor form functionality
    document.getElementById('contributorForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const form = new FormData(e.target);
  
      const res = await fetch('/api/submit', {
        method: 'POST',
        body: form
      });
  
      const msg = await res.text();
      document.getElementById('contribMessage').textContent = msg;
      e.target.reset();
    });
    // Auto-scroll to the section after showing it
function scrollToSection(id) {
  const element = document.getElementById(id);
  setTimeout(() => {
    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 150); // Wait for display to become visible
}

// Update click events to include scroll
  document.querySelector('a[href="#starter"]').addEventListener('click', function(e) {
  e.preventDefault();
  showSection('starter');
  scrollToSection('starter');
});

  document.querySelector('a[href="#contributor"]').addEventListener('click', function(e) {
  e.preventDefault();
  showSection('contributor');
  scrollToSection('contributor');
});
document.getElementById('starterForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    const budget = document.getElementById('budget').value;

    const res = await fetch('/api/ideas?budget=' + budget);
    const ideas = await res.json();

    const container = document.getElementById('ideasContainer');
    container.innerHTML = '';

    if (ideas.length === 0) {
      container.innerHTML = '<p>No ideas found for this budget range.</p>';
    } else {
      ideas.forEach(idea => {
        const div = document.createElement('div');
        div.className = 'idea-card';
        div.innerHTML = `
          <strong>${idea.idea}</strong> <br>
          <em>in ${idea.location}</em><br>
          <button class="like-btn" data-id="${idea.id}">
            üëç <span>${idea.likes}</span>
          </button>
        `;
        container.appendChild(div);
      });

      // Add event listeners for like buttons
      document.querySelectorAll('.like-btn').forEach(btn => {
        btn.addEventListener('click', async function () {
          const id = this.dataset.id;
          const res = await fetch('/api/uplift/' + id, { method: 'POST' });
          const data = await res.json();
          this.querySelector('span').textContent = data.likes;
        });
      });
    }
  });
  document.getElementById('starterForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    const budget = document.getElementById('budget').value;

    const res = await fetch('/api/ideas?budget=' + budget);
    const ideas = await res.json();

    const container = document.getElementById('ideasContainer');
    container.innerHTML = '';

    if (ideas.length === 0) {
      container.innerHTML = '<p>No ideas found for this budget range.</p>';
    } else {
      ideas.forEach(idea => {
        const alreadyLiked = localStorage.getItem('liked_' + idea.id);

        const div = document.createElement('div');
        div.className = 'idea-card';
        div.innerHTML = `
          <strong>${idea.idea}</strong> <br>
          <em>in ${idea.location}</em><br>
          <button class="like-btn" data-id="${idea.id}" ${alreadyLiked ? 'disabled' : ''}>
            üëç <span>${idea.likes}</span>
          </button>
        `;
        container.appendChild(div);
      });

      document.querySelectorAll('.like-btn').forEach(btn => {
        btn.addEventListener('click', async function () {
          const id = this.dataset.id;

          if (localStorage.getItem('liked_' + id)) return;

          const res = await fetch('/api/uplift/' + id, { method: 'POST' });
          const data = await res.json();
          this.querySelector('span').textContent = data.likes;
          this.disabled = true;

          localStorage.setItem('liked_' + id, 'true');
        });
      });
    }
  });

  </script>
  
</body>
</html>